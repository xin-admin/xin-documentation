---
group:
  title: 基础教程
  order: 5
title: 菜单权限
order: 1
description: XinAdmin文档 - XinAdmin 实现了非常强大的路由与权限模块。
---

XinAdmin 实现了非常强大的路由与权限模块。

- 菜单与权限后台编辑
- WEB 端文件路由系统
- WEB 端按钮级权限校验
- 无限子级菜单
- 前后两端双鉴权
- 后端注解权限路由

<hr>

## 基础知识

在中后台管理系统中，菜单一般以侧边栏的形式展示，`XinAdmin` 通过对 UmiJs `文件路由系统`与`权限`结合，使得实现后台动态菜单以及权限控制功能。

文件路由系统是指通过文件目录来生成路由，比如`/pages/User/index.tsx`，那么就会生成一个路由`/user`，通过`/user`访问到`/pages/User/index.tsx`页面。

而权限则控制那个页面可以被那个角色用户所访问

在后台中，权限负责控制接口的访问权限，比如控制器方法需要权限`user.list`，只有拥有权限`user.list`的用户才能访问到该接口，否则会返回无权限的响应。

:::info{title=Tips}

1. 用户仅能看到有权限访问的菜单
2. 用户仅能看到有权限操作的按钮，比如 添加、编辑、删除 按钮都是按权限进行显示的
3. 系统管理员账户可以访问所有已经注册的权限，并且不可修改管理员权限
4. 新增加的页面需要注册权限后才会在菜单中显示
5. 新增加的控制器接口，需要在管理员权限中添加后才可以访问接口
   :::

## 页面菜单权限

当你在`pages`目录下新增一个页面后，你需要在后台的权限管理中去添加这个页面的菜单，菜单的类型分为两种，一种一级菜单，一种是子菜单，子菜单可以选择父级并作为子菜单的形式展示。

<img src="./img/img4.png" alt="">

以下是具体配置的解析：

- `标题`：菜单的标题，如果未配置多语言，该项目作为菜单的 label
- `路由地址`：菜单的路由地址，文件系统的文件目录名称
  比如`/pages/User/index.tsx` 文件，对应的路由地址为`/user`
- `父级菜单`：菜单的父级菜单，子菜单必填
- `图标`：菜单的图标，使用 Ant Design 的图标库，自定义参考[图标](/)
- `多语言`：多语言配置，如果未配置多语言，则使用`标题`作为菜单的 label
- `权限标识`：菜单的权限标识
  例: 路由地址 "/index/user" , 权限标识为 "index.user"，不区分大小写
- `排序`：菜单的排序，越小越靠前
- `显示状态`：是否隐藏菜单，隐藏后，菜单将不会在侧边栏中显示，但是用户可以访问到该页面
- `禁用状态`：是否禁用菜单，禁用后，用户将不能访问到该页面，并且用户没有该权限

## 按钮 API 权限

按钮权限是针对页面的按钮，比如`添加`、`编辑`、`删除`等按钮，通过配置权限标识，可以控制用户是否可以访问到这些按钮。

<img src="./img/img5.png" alt="">

以下是具体配置的解析：

- `标题`：按钮的标题
- `权限标识`：按钮的权限标识，与后台的 API 接口权限标识保持一致，不区分大小写，你也可以单独当作按钮或者 API 权限使用
- `排序`：按钮的排序，越小越靠前
- `显示状态`：是否隐藏按钮，隐藏后，按钮将不会在页面中显示，但是用户可以访问到该按钮
- `禁用状态`：是否禁用按钮，禁用后，用户将不能访问到该按钮，并且用户没有该权限

## 权限使用

在实际应用过程中，路由权限通常作为一组接口权限或者按钮权限的前缀.。

我们在前端项目目录下新建一个文件：`pages/User/index.tsx`，它的文件系统路由为 `/user`， 页面中有编辑用户信息按钮，用来请求后台编辑用户信息。

```tsx | pure
// pages/User/index.tsx
export default () => {
  return (
    <Button type="primary" onClick={() => {}}>
      {' '}
      编辑用户信息{' '}
    </Button>
  );
};
```

首先我们添加`/user` 页面权限

<img src="./img/img6.png" alt="">

然后添加按钮权限

<img src="./img/img7.png" alt="">

将`user.edit`权限添加到按钮上：

```tsx | pure
<ButtonAccess auth={'user.edit'}>
  <Button type="primary" onClick={() => {}}>
    编辑用户信息
  </Button>
</ButtonAccess>
```

将`user.edit`权限添加到控制器的方法中：

```php
#[Authorize('user.edit')]
public function edit(): JsonResponse
{
    return $this->success();
}
```

之后你就可以在角色中给不同的用户角色分配这个权限。
